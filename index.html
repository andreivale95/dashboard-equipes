function doGet(request) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Equipes");
  if (!sheet) {
    throw new Error("A aba 'Equipes' não foi encontrada.");
  }

  const data = sheet.getDataRange().getValues();
  const headers = data[0]; // Primeira linha é o cabeçalho
  const equipes = [];

  // Converte os dados da planilha em um array de objetos
  for (let i = 1; i < data.length; i++) {
    const equipe = {};
    for (let j = 0; j < headers.length; j++) {
      const chave = headers[j].toLowerCase().replace(/ /g, "_");
      equipe[chave] = data[i][j];
    }
    equipes.push(equipe);
  }

  // Retorna os dados em formato JSONP
  const callback = request.parameter.callback;
  if (callback) {
    return ContentService.createTextOutput(`${callback}(${JSON.stringify(equipes)})`).setMimeType(ContentService.MimeType.JAVASCRIPT);
  } else {
    return ContentService.createTextOutput(JSON.stringify(equipes)).setMimeType(ContentService.MimeType.JSON);
  }
}
